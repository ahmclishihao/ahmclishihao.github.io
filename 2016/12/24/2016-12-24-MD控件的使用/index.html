<!DOCTYPE html><html lang="zh_CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> MD控件的使用 · 潜水的沙 -- Java 开发者</title><meta name="description" content="MD控件的使用 - 潜水的沙"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://lshao.xyz/atom.xml" title="潜水的沙 -- Java 开发者"></head><body><div class="wrap"><header><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">潜水的沙</a></li><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/ahmclishihao" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="http://blog.csdn.net/ahmclishihao" target="_blank" class="nav-list-link">CSDN</a></li><li class="nav-list-item"><a href="/about/" target="_self" class="nav-list-link">ABOUT</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">MD控件的使用</h1><div class="post-info">2016年12月24日</div><div class="post-content"><p>Material Desgin风格控件的使用。Google官方design support包里的新控件，虽然好看，但是用起来还真不是一次就能搞定的。</p>
<a id="more"></a>
<h3 id="layout-scrollFlags属性"><a href="#layout-scrollFlags属性" class="headerlink" title="layout_scrollFlags属性"></a>layout_scrollFlags属性</h3><p>AppBarLayout的子布局有5种滚动标识(就是上面代码CollapsingToolbarLayout中配置的app:layout_scrollFlags属性)：</p>
<p>1、scroll:将此布局和滚动时间关联。这个标识要设置在其他标识之前，没有这个标识则布局不会滚动且其他标识设置无效。</p>
<p>2、enterAlways:任何向下滚动操作都会使此布局可见。这个标识通常被称为“快速返回”模式。</p>
<p>3、enterAlwaysCollapsed：假设你定义了一个最小高度（minHeight）同时enterAlways也定义了，那么view将在到达这个最小高度的时候开始显示，并且从这个时候开始慢慢展开，当滚动到顶部的时候展开完。</p>
<p>4、exitUntilCollapsed：当你定义了一个minHeight，此布局将在滚动到达这个最小高度的时候折叠。</p>
<p>5、snap:当一个滚动事件结束，如果视图是部分可见的，那么它将被滚动到收缩或展开。例如，如果视图只有底部25%显示，它将折叠。相反，如果它的底部75%可见，那么它将完全展开。</p>
<h3 id="fitSystemWindow"><a href="#fitSystemWindow" class="headerlink" title="fitSystemWindow"></a>fitSystemWindow</h3><p>以CoordinatorLayout为根布局时且设置 fit = true 控件会自己适应并填充状态栏</p>
<p>而普通的控件 fit = true 则会与状态栏间隔，fit = false 则会跑到状态中去<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"android:statusBarColor"</span>&gt;</span>@android:color/transparent<span class="tag">&lt;/<span class="name">item</span>&gt;</span> （5.0） 该属性 不会让布局内容填充到状态栏中 就算设置fitSystemWindow = false</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"android:windowTranslucentStatus"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">item</span>&gt;</span> （4.4属性） 该属性会让布局内容填充到状态栏中 不想填充到状态栏的控件设置 fit = true ； 想填充到状态栏的设置 fit = false （4.4中填充到状态栏就看不到控件了）</span><br></pre></td></tr></table></figure></p>
<h3 id="ActionBar-颜色-对应的主题"><a href="#ActionBar-颜色-对应的主题" class="headerlink" title="ActionBar 颜色 对应的主题"></a>ActionBar 颜色 对应的主题</h3><p>黑字 黑图标： app:theme=”@style/Theme.AppCompat.Light”</p>
<p>白字 白图标： app:theme=”@style/Theme.AppCompat”</p>
<h3 id="PopuWindow-颜色-对应的主题"><a href="#PopuWindow-颜色-对应的主题" class="headerlink" title="PopuWindow 颜色 对应的主题"></a>PopuWindow 颜色 对应的主题</h3><p>黑底 白字：app:popupTheme=”@style/ThemeOverlay.AppCompat.Dark”</p>
<p>白底 黑字：app:popupTheme=”@style/ThemeOverlay.AppCompat.Light”</p>
<h3 id="CollapseToolBarLayout-的使用"><a href="#CollapseToolBarLayout-的使用" class="headerlink" title="CollapseToolBarLayout 的使用"></a>CollapseToolBarLayout 的使用</h3><p>CollapseToolBarLayout中 ：<br>1、toolbar 要写在最下面 否则会有一系列失效</p>
<p>2、同时配置的ImageView要 fit = true才会填充状态栏</p>
<p>3、toolBar不随折叠变换 设置 collapsing.setTitleEnabled(false); 或 app:titleEnabled=”false” </p>
<p>4、title 改变文字 文字可折叠时通过collapse设置 不可折叠时通过toolbar先app:title=”tool bar 先设置一次 才可以写字” 然后才可以设置文字</p>
<p>5、折叠后内容的颜色 app:contentScrim=”#FF4081” 状态栏的颜色 app:statusBarScrim=”@android:color/transparent”</p>
<p>如下是一个标准的配置<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">android.support.design.widget.AppBarLayout</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"260dp"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:fitsSystemWindows</span>=<span class="string">"true"</span><span class="attr">------</span>》》》<span class="attr">fit</span>后填充状态栏</span></span><br><span class="line"><span class="tag">        <span class="attr">app:theme</span>=<span class="string">"@style/Theme.AppCompat"</span></span></span><br><span class="line"><span class="tag">        &gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">android.support.design.widget.CollapsingToolbarLayout</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:id</span>=<span class="string">"@+id/collapsing"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">app:contentScrim</span>=<span class="string">"#FF4081"</span> <span class="attr">----------</span>》》》折叠后颜色</span></span><br><span class="line"><span class="tag"><span class="attr">app:statusBarScrim</span>=<span class="string">"@android:color/transparent"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">app:titleEnabled</span>=<span class="string">"false"</span><span class="attr">------------</span>》》》<span class="attr">title</span>不伸缩</span></span><br><span class="line"><span class="tag">            <span class="attr">app:layout_scrollFlags</span>=<span class="string">"scroll|snap|exitUntilCollapsed"</span> <span class="attr">----</span>》》》滑动类型</span></span><br><span class="line"><span class="tag">            &gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">ImageView</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:fitsSystemWindows</span>=<span class="string">"true"</span><span class="attr">------</span>》》》<span class="attr">fit</span>后图片填充状态栏</span></span><br><span class="line"><span class="tag">                <span class="attr">android:scaleType</span>=<span class="string">"centerCrop"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:src</span>=<span class="string">"@drawable/test_pic"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_collapseMode</span>=<span class="string">"parallax"</span><span class="attr">----</span>》》》缩放模式</span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_collapseParallaxMultiplier</span>=<span class="string">"0.7"</span><span class="attr">---</span>》》》缩放比例</span></span><br><span class="line"><span class="tag">/&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">android.support.v7.widget.Toolbar-------》》》toolbar要写在最下面</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:id</span>=<span class="string">"@+id/toolbar"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:layout_height</span>=<span class="string">"?attr/actionBarSize"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">android:theme</span>=<span class="string">"@style/Theme.AppCompat"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">app:title</span>=<span class="string">"tool bar 先设置一次 才可以写字"</span> <span class="attr">----</span>》》》必须先设置一次</span></span><br><span class="line"><span class="tag">                <span class="attr">app:layout_collapseMode</span>=<span class="string">"pin"</span><span class="attr">-----</span>》》》固定模式</span></span><br><span class="line"><span class="tag">                <span class="attr">app:popupTheme</span>=<span class="string">"@style/ThemeOverlay.AppCompat.Light"</span></span></span><br><span class="line"><span class="tag">                /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">android.support.design.widget.CollapsingToolbarLayout</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">android.support.design.widget.AppBarLayout</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>效果图：<img src="/img/collapselayout.gif" width="320" height="480"></p>
<h3 id="CoordinatorLayout-是怎么做到适应状态栏的？"><a href="#CoordinatorLayout-是怎么做到适应状态栏的？" class="headerlink" title="CoordinatorLayout 是怎么做到适应状态栏的？"></a>CoordinatorLayout 是怎么做到适应状态栏的？</h3><p>构造函数中调用 setupForInsets</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">CoordinatorLayout</span><span class="params">(Context context, AttributeSet attrs, <span class="keyword">int</span> defStyleAttr)</span> </span>&#123;</span><br><span class="line">      <span class="keyword">super</span>(context, attrs, defStyleAttr);</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">      mStatusBarBackground = a.getDrawable(R.styleable.CoordinatorLayout_statusBarBackground);<span class="comment">//-----》》》获取背景drawable</span></span><br><span class="line">      </span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">      setupForInsets();<span class="comment">//-------------》》》》调用</span></span><br><span class="line"></span><br><span class="line">      <span class="keyword">super</span>.setOnHierarchyChangeListener(<span class="keyword">new</span> HierarchyChangeListener());</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>根据是否fitsSystemWindows来设置不同的 ui标签<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">setupForInsets</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		</span><br><span class="line">    <span class="keyword">if</span> (Build.VERSION.SDK_INT &lt; <span class="number">21</span>) &#123;<span class="comment">// ----》》》5.0一下不适用</span></span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (ViewCompat.getFitsSystemWindows(<span class="keyword">this</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (mApplyWindowInsetsListener == <span class="keyword">null</span>) &#123;</span><br><span class="line">            mApplyWindowInsetsListener =</span><br><span class="line">                    <span class="keyword">new</span> android.support.v4.view.OnApplyWindowInsetsListener() &#123;</span><br><span class="line">                        <span class="meta">@Override</span></span><br><span class="line">                        <span class="function"><span class="keyword">public</span> WindowInsetsCompat <span class="title">onApplyWindowInsets</span><span class="params">(View v,</span></span></span><br><span class="line"><span class="function"><span class="params">                                WindowInsetsCompat insets)</span> </span>&#123;</span><br><span class="line">                            <span class="keyword">return</span> setWindowInsets(insets);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// First apply the insets listener</span></span><br><span class="line">        ViewCompat.setOnApplyWindowInsetsListener(<span class="keyword">this</span>, mApplyWindowInsetsListener);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Now set the sys ui flags to enable us to lay out in the window insets</span></span><br><span class="line">        setSystemUiVisibility(View.SYSTEM_UI_FLAG_LAYOUT_STABLE</span><br><span class="line">                | View.SYSTEM_UI_FLAG_LAYOUT_FULLSCREEN);<span class="comment">//----》》》设置UI标签</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        ViewCompat.setOnApplyWindowInsetsListener(<span class="keyword">this</span>, <span class="keyword">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="水波纹特效"><a href="#水波纹特效" class="headerlink" title="水波纹特效"></a>水波纹特效</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ripple</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">android:color</span>=<span class="string">"@color/touch_effect"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">android:id</span>=<span class="string">"@android:id/mask"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">shape</span> <span class="attr">android:shape</span>=<span class="string">"rectangle"</span>&gt;</span></span><br><span class="line">	    <span class="tag">&lt;<span class="name">solid</span> <span class="attr">android:color</span>=<span class="string">"@android:color/white"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">shape</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">item</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ripple</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="水波纹揭示效果"><a href="#水波纹揭示效果" class="headerlink" title="水波纹揭示效果"></a>水波纹揭示效果</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ViewAnimationUtils.createCircularReveal(View view, <span class="keyword">int</span> centerX, <span class="keyword">int</span> centerY, <span class="keyword">float</span> startRadius, <span class="keyword">float</span> endRadius)</span><br></pre></td></tr></table></figure>
</div></article></div></main><footer><div class="paginator"><a href="/2016/12/30/2016-12-30-自定义View高级知识点(一)/" class="prev">PREV</a><a href="/2016/11/13/2016-11-13-SurfaceView的使用/" class="next">NEXT</a></div><div class="copyright"><p>© 2016 - 2018 <a href="http://lshao.xyz">潜水的沙</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script></body></html>